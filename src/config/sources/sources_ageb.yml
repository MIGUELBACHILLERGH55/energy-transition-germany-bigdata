ageb:
  # ------------------------------------------------------------
  # AG Energiebilanzen — National Energy Balance (Germany)
  # ------------------------------------------------------------
  # This source is file-based: Excel workbooks manually downloaded
  # from AGEB and stored under data/landing/ageb.
  #
  # It is used to reconstruct long-term energy balances
  # (production, trade, transformation, final consumption, etc.)
  # from 1990/2000 onwards.
  # ------------------------------------------------------------
  enabled: true
  kind: file # Access type: local files, not an API.

  datasets:
    # --------------------------------------------------------
    # Annual Energy Balance Workbooks (Energy Balance 2000–2030)
    # --------------------------------------------------------
    energy_balance_annual:
      enabled: true
      access: file

      # Raw files as downloaded from AGEB.
      # With base_path = "data", this becomes:
      #   data/landing/ageb/energy_balance_2000.xls
      #   data/landing/ageb/energy_balance_2001.xls
      #   ...
      excel:
        sheets:
          - name: "tj"
            sections:
              - id: "TJ"
                header_row: 4
                row_range: { start: 8, end: 75 }
            select: ["TJ"]

      storage:
        path: "ageb/"
        format: excel
        pattern: "energy_balance_*.xls*"

      metadata:
        dataset_id: "ageb.energy_balance.annual"
        description: "Annual energy balance workbooks for Germany (Energy Balance 2000–2030)."
        country: "DE"
        unit: "PJ / ktoe (depending on table)"
        source_resolution: "year"
        granularity: yearly
        tz: "UTC"
        schedule: ad_hoc # Updated when new AGEB releases are downloaded
        format: excel

      destinations:
        bronze:
          # One row per (year, carrier, sector) after flattening all Excel files.
          path: "ageb/energy_balance_raw/"
          format: parquet
        silver:
          # Cleaned, normalised table ready for joins with OPSD/EEA.
          path: "ageb/energy_balance_by_sector/"
          format: parquet
        gold:
          # High-level aggregates (e.g. total primary energy, RES share, etc.).
          path: "ageb/energy_balance_aggregated/"
          format: parquet

    # --------------------------------------------------------
    # Evaluation Tables (Evaluation Tables on the Energy Balance)
    # --------------------------------------------------------
    evaluation_tables:
      enabled: true
      access: file

      # Aggregated time series from AGEB evaluation tables.
      # e.g. data/landing/ageb/evaluation_tables.xlsx
      excel:
        sheets:
          - name: "1.1"
            title: "Indigenous energy production by energy source"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 12 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 15, end: 21 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 24, end: 30 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 33, end: 39 }
            select: ["PJ"]
          - name: "1.2"
            title: "Import by energy source"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]
          - name: "1.3"
            title: "Export by energy source"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]

          - name: "2.1"
            title: "Primary energy consumption by energy source"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]

          - name: "2.2"
            title: "Structure of energy consumption by sector"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 16 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 18, end: 28 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 30, end: 40 }
            select: ["PJ"]

          - name: "3.1"
            title: "Renewables' primary energy consumption"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]

          - name: "4.1"
            title: "Transformation input for electricity generation by energy source"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]

          - name: "5.1"
            title: "CHP plants: generation and energy input"
            sections:
              - id: "GENERATION_TWH"
                header_row: 4
                row_range: { start: 6, end: 10 }
              - id: "TRANSFORMATION_INPUT_PJ"
                header_row: 4
                row_range: { start: 13, end: 15 }
              - id: "EFFICIENCY_PCT"
                header_row: 4
                row_range: { start: 18, end: 19 }
              - id: "CHP_SHARE_PCT"
                header_row: 4
                row_range: { start: 21, end: 21 }
            select: ["GENERATION_TWH", "TRANSFORMATION_INPUT_PJ"]

          - name: "6.1"
            title: "Total final energy consumption by energy source"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]
          - name: "6.2"
            title: "Final energy consumption by energy source: Mining and quarrying, manufacturing industry"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]
          - name: "6.3"
            title: "Final energy consumption by energy source: private households"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]
          - name: "6.4"
            title: "Final energy consumption by energy source: trade, commerce and services (TCS)"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]
          - name: "6.6"
            title: "Final energy consumption by energy source: transport"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 14 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 17, end: 25 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 28, end: 36 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 39, end: 47 }
            select: ["PJ"]
          - name: "6.7"
            title: "Final energy consumption: transport by sectors and selected energy sources"
            sections:
              - id: "PJ"
                header_row: 4
                row_range: { start: 6, end: 12 }
              - id: "TCE"
                header_row: 4
                row_range: { start: 15, end: 21 }
              - id: "PCT"
                header_row: 4
                row_range: { start: 24, end: 30 }
              - id: "DELTA_PCT"
                header_row: 4
                row_range: { start: 33, end: 39 }
            select: ["PJ"]
          - name: "7.1"
            title: "Energy efficiency indicators"
            sections:
              - id: "ACTIVITY_VARS"
                header_row: 4
                row_range: { start: 6, end: 11 }
              - id: "ENERGY_INTENSITY"
                header_row: 4
                row_range: { start: 13, end: 22 }
              - id: "ENERGY_INTENSITY_DELTA_PCT"
                header_row: 4
                row_range: { start: 24, end: 33 }
            select: ["ENERGY_INTENSITY"]

      storage:
        path: "ageb/"
        format: excel
        file_name: "evaluation_tables.xlsx"

      metadata:
        dataset_id: "ageb.energy_balance.evaluation_tables"
        description: "Evaluation tables with aggregated energy statistics for Germany (1990–2024)."
        country: "DE"
        unit: "PJ / %, coal-equivalent"
        source_resolution: "year"
        granularity: yearly
        tz: "UTC"
        schedule: ad_hoc
        format: excel

      destinations:
        bronze:
          path: "ageb/evaluation_tables_raw/"
          format: parquet
        silver:
          path: "ageb/evaluation_tables_normalised/"
          format: parquet
        gold:
          path: "ageb/evaluation_tables_indicators/"
          format: parquet
